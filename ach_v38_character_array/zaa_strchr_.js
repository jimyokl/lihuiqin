
p_end = strchr(p_start, '"');

~~~~~~~~~~~~~------------------ä¸€:è§£é‡Š:p_start = strstr(json_buf, "\"encrypted_key\":\"");~~~~~~~~~~~~~------------------

    ä½œç”¨æ˜¯ä»å­—ç¬¦ä¸² `json_buf` ä¸­æŸ¥æ‰¾å­å­—ç¬¦ä¸² `"\"encrypted_key\":\""` çš„ä½ç½®ã€‚

1. strstr()æ˜¯Cè¯­è¨€æ ‡å‡†åº“ä¸­çš„å‡½æ•°,ç”¨æ¥æŸ¥æ‰¾ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆå­å­—ç¬¦ä¸²ï¼‰åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„é¦–æ¬¡å‡ºç°ä½ç½®ã€‚å…¶å‡½æ•°åŸå‹ä¸ºï¼š

   char *strstr(const char *haystack, const char *needle); haystackæ˜¯è¦æœç´¢çš„ç›®æ ‡å­—ç¬¦ä¸², needleæ˜¯ä½ æƒ³è¦æŸ¥æ‰¾çš„å­å­—ç¬¦ä¸²

2. json_bufè¿™æ˜¯ä¸€ä¸ªåŒ…å« JSON æ•°æ®çš„å­—ç¬¦æ•°ç»„æˆ–å­—ç¬¦ä¸²,ä»£ç ä¸­çš„`json_buf`åº”è¯¥æ˜¯ä¸€ä¸ªåŒ…å«æŸäº›å†…å®¹çš„å­—ç¬¦ä¸²,æ¯”å¦‚ä¸€ä¸ªåŠ å¯†åçš„JSONæ•°æ®.

3."\"encrypted_key\":\"":è¿™æ˜¯ä½ è¦æŸ¥æ‰¾çš„å­å­—ç¬¦ä¸²ã€‚
    ç”±äº`"`æ˜¯ C è¯­è¨€ä¸­çš„å­—ç¬¦ä¸²å®šç•Œç¬¦ï¼Œæ‰€ä»¥åœ¨å­—ç¬¦ä¸²ä¸­éœ€è¦ä½¿ç”¨ `\` æ¥è½¬ä¹‰åŒå¼•å·ã€‚
    è¿™ä¸ªå­—ç¬¦ä¸²çš„å®é™…å†…å®¹æ˜¯ï¼š

   "encrypted_key":", è¿™å¯èƒ½æ˜¯ JSON æ•°æ®ä¸­çš„ä¸€ä¸ªå­—æ®µï¼Œç”¨æ¥è¡¨ç¤ºåŠ å¯†å¯†é’¥ã€‚

4. p_startè¿™æ˜¯ä¸€ä¸ªæŒ‡å‘å­—ç¬¦çš„æŒ‡é’ˆ,å®ƒå°†å­˜å‚¨æŸ¥æ‰¾ç»“æœ. strstr()å‡½æ•°è¿”å›çš„æ˜¯å­å­—ç¬¦ä¸²åœ¨ç›®æ ‡å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®çš„æŒ‡é’ˆã€‚
    å¦‚æœæ‰¾åˆ°äº†"\"encrypted_key\":\"", p_startå°†æŒ‡å‘å®ƒåœ¨ `json_buf` ä¸­çš„èµ·å§‹ä½ç½®ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œ`strstr()` ä¼šè¿”å› `NULL`

5. æ€»ç»“: è¯¥è¡Œä»£ç çš„ä½œç”¨æ˜¯æŸ¥æ‰¾json_bufä¸­æ˜¯å¦åŒ…å«"encrypted_key":" è¿™ä¸ªå­—æ®µ                """
      å¦‚æœæ‰¾åˆ°äº†`p_start` å°†æŒ‡å‘è¯¥å­—æ®µå¼€å§‹çš„ä½ç½®ï¼Œ
      æ–¹ä¾¿åç»­çš„æ“ä½œï¼Œæ¯”å¦‚æå–åŠ å¯†å¯†é’¥çš„å€¼ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œ`p_start` ä¼šæ˜¯ `NULL`

~~~~~~~~~~~~~------------------äºŒ:æ‰“å°è¿™ä¸ªäºŒè¿›åˆ¶æ•°æ®decoded_keyå—~~~~~~~~~~~~~------------------

    unsigned char *decoded_key = base64_decode(base64_key, strlen(base64_key), &base64_len);
    è§£ç æˆåŸå§‹çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œæˆ‘å¯ä»¥æ‰“å°è¿™ä¸ªäºŒè¿›åˆ¶æ•°æ®decoded_keyå—
    if (!decoded_key) {  fprintf(stderr, "base64 è§£ç å¤±è´¥\n");    return 0; }
    int ret = decrypt_aes_key(decoded_key, base64_len, out_key, out_key_len); //è§£å¯†DPAPIå‰ç¼€çš„å¯†é’¥
    free(decoded_key);
    if (!ret) {        fprintf(stderr, "DPAPI è§£å¯† Chrome AES key å¤±è´¥\n");  return 0;   }

1. åŸå§‹äºŒè¿›åˆ¶æ•°æ®çš„ç‰¹ç‚¹:
    * å®ƒ**å¯èƒ½åŒ…å«ä¸å¯æ‰“å°å­—ç¬¦**ï¼ˆä¾‹å¦‚ ASCII æ§åˆ¶å­—ç¬¦ã€0x00ã€0xFF ç­‰ï¼‰ã€‚
    * æ‰€ä»¥ä¸èƒ½ç›´æ¥ç”¨ `printf("%s", decoded_key);`ï¼Œé‚£ä¼šï¼š

    * æ‰“å°ä¹±ç 
    * é‡åˆ° `\0` æå‰ç»ˆæ­¢
    * å¼•å‘è¾“å‡ºé”™è¯¯

2. æ–¹å¼1:ä»¥åå…­è¿›åˆ¶å½¢å¼æ‰“å°ï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼š
        for (size_t i = 0; i < base64_len; i++) {
            printf("%02X ", decoded_key[i]);
        }
        printf("\n");

        * `%02X` ä¼šæŠŠæ¯ä¸ªå­—èŠ‚æ‰“å°æˆä¸¤ä½åå…­è¿›åˆ¶æ•°ï¼ˆå¤§å†™ï¼‰
        * ä¾‹å¦‚è¾“å‡ºï¼š`01 FF A3 9C 7D ...`

   æ–¹å¼2:ä»¥åè¿›åˆ¶æ‰“å°æ¯ä¸ªå­—èŠ‚ï¼ˆä¸å¸¸è§ï¼‰
        for (size_t i = 0; i < base64_len; i++) {
            printf("%d ", decoded_key[i]);
        }
        printf("\n");
   æ–¹å¼3:ä»¥ Base64 å†æ‰“å°å›å»ï¼ˆä¸å¤ªå¸¸ç”¨ï¼‰

    å¦‚æœä½ åªæ˜¯æƒ³â€œçœ‹çœ‹å®ƒçš„æ ·å­â€ï¼Œä¸å…³å¿ƒå…·ä½“å­—èŠ‚å†…å®¹ï¼Œå¯ä»¥é‡æ–°ç¼–ç ä¸º Base64 æˆ–è½¬æˆåå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚

3. è¡¥å……å»ºè®®:
        * å¦‚æœä½ **å¸Œæœ›ä¿å­˜æˆæ–‡ä»¶**ï¼ˆå¦‚äºŒè¿›åˆ¶å¯†é’¥æ–‡ä»¶ï¼‰ï¼Œå¯ä»¥è¿™æ ·ï¼š

        FILE *fp = fopen("key.bin", "wb");
        fwrite(decoded_key, 1, base64_len, fp);
        fclose(fp);

        * å¦‚æœä½ æƒ³åœ¨è°ƒè¯•ä¸­â€œå¯è§†åŒ–â€è¿™ä¸ªå¯†é’¥ï¼Œ**åå…­è¿›åˆ¶æ‰“å°æœ€æ¸…æ™°**ï¼Œå¯ä¾›ä½ åç»­æ¯”å¯¹ã€éªŒè¯ã€‚
4. ç¤ºä¾‹å®Œæ•´ä»£ç ç‰‡æ®µï¼š
        unsigned char *decoded_key = base64_decode(base64_key, strlen(base64_key), &base64_len);
        if (decoded_key) {
            printf("Decoded key (%zu bytes):\n", base64_len);
            for (size_t i = 0; i < base64_len; i++) {
                printf("%02X ", decoded_key[i]);
            }
            printf("\n");

            free(decoded_key);
        } else {
            fprintf(stderr, "Base64 è§£ç å¤±è´¥\n");
        }
    å¦‚æœä½ æƒ³è®©æˆ‘å¸®ä½ å†™ä¸€ä¸ªå‡½æ•° `print_hex(const unsigned char *data, size_t len)` æ¥å°è£…è¿™ä¸ªåŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥å‘Šè¯‰æˆ‘ã€‚

    Decrypted AES key (32 bytes):
    F4 D9 23 6B AD D2 9A 78 8D 45 BB 0B 81 D4 24 3C 22 29 B0 CB D9 2E E3 6A 87 41 99 F4 81 9C B5 B0ï¼Œçœ‹èµ·æ¥åƒaeså¯†é’¥å— 

    æ˜¯çš„ï¼Œä½ æ‰“å°å‡ºæ¥çš„è¿™æ®µï¼š
    F4 D9 23 6B AD D2 9A 78 8D 45 BB 0B 81 D4 24 3C
    22 29 B0 CB D9 2E E3 6A 87 41 99 F4 81 9C B5 B0
    **ç¡®å®çœ‹èµ·æ¥åƒä¸€ä¸ªåˆæ³•çš„ AES å¯†é’¥**ã€‚

å…·ä½“åˆ†æï¼š

* é•¿åº¦ï¼š**32 å­—èŠ‚** âœ…
  â†’ è¿™æ˜¯ **AES-256** çš„å¯†é’¥é•¿åº¦ï¼ˆå¯¹åº” AES-256-CBCã€AES-256-GCM ç­‰åŠ å¯†æ¨¡å¼ï¼‰ï¼›

* å†…å®¹ï¼š**éšæœºæ€§å¾ˆå¥½** âœ…
  â†’ å«æœ‰é«˜ä½å­—èŠ‚ï¼Œå­—ç¬¦åˆ†å¸ƒçœ‹èµ·æ¥æ¯”è¾ƒéšæœºï¼ˆæ²¡æœ‰æ˜æ˜¾çš„æ˜æ–‡æˆ–é‡å¤æ¨¡å¼ï¼‰ï¼›

* ç¼–ç æ ¼å¼ï¼šä½ ä¹‹å‰æ˜¯å…ˆåšäº† Base64 è§£ç ï¼Œå†é€šè¿‡ `decrypt_aes_key(...)` å¾—åˆ°çš„ç»“æœï¼Œ
è¿™é€šå¸¸æ˜¯ä» Chromeã€Edge ç­‰æµè§ˆå™¨ä¸­æå–çš„åŠ å¯† AES å¯†é’¥ï¼Œè¿™ç§ç”¨æ³•éå¸¸å¸¸è§ã€‚

---

### ğŸ” AES å¯†é’¥ç‰¹ç‚¹ï¼ˆä½ å¯¹æ¯”ä¸€ä¸‹ï¼‰ï¼š

| å±æ€§        | ä½ è¿™æ®µå¯†é’¥æ˜¯å¦æ»¡è¶³   |
| --------- | ----------- |
| é•¿åº¦ä¸º 32 å­—èŠ‚ | âœ… æ˜¯ AES-256 |
| å«é«˜ä½å­—èŠ‚     | âœ… æ˜¯         |
| çœ‹èµ·æ¥ä¸é‡å¤    | âœ… æ˜¯         |
| ä¸å¯è¯»æ–‡æœ¬     | âœ… æ˜¯         |

---

### âœ… åˆ¤æ–­æ ‡å‡†ï¼š

ä½ å·²ç»å®Œæˆäº†è§£å¯†ã€æ‰“å°æ­¥éª¤ï¼Œå¦‚æœä½ ä¸‹ä¸€æ­¥æ‹¿è¿™ä¸ª `out_key` å»è§£å¯† Chrome Cookiesã€Login Dataã€Tokens ç­‰å†…å®¹ï¼Œ
å°±å¯ä»¥æ£€éªŒå®ƒæ˜¯å¦æœ‰æ•ˆï¼ˆæ¯”å¦‚å°è¯• AES-GCM è§£å¯† payloadï¼Œå¦‚æœèƒ½æˆåŠŸå¹¶é€šè¿‡ tag æ ¡éªŒï¼Œé‚£å°± 100% æ˜¯æ­£ç¡®å¯†é’¥ï¼‰ã€‚

---

### ğŸ§  å°å»ºè®®ï¼š

å¦‚æœä½ æ‰“ç®—å¤§é‡å¤„ç† AES å¯†é’¥å’Œå¯†æ–‡ï¼Œå¯ä»¥å†™ä¸€ä¸ª `print_hex(const unsigned char *data, size_t len)` å‡½æ•°ï¼Œæå‡å¯è¯»æ€§ã€‚ä¾‹å¦‚ï¼š

```c
void print_hex(const unsigned char *data, size_t len) {
    for (size_t i = 0; i < len; ++i) {
        printf("%02X ", data[i]);
        if ((i + 1) % 16 == 0) printf("\n");
    }
    printf("\n");
}

æ€»ç»“ï¼šæ˜¯çš„ï¼Œè¿™æ®µç¡®å®éå¸¸åƒä¸€ä¸ªåˆæ³•çš„ **AES-256 å¯†é’¥**ï¼Œå¦‚æœä½ æ˜¯ä» Chrome/Edge çš„ `Local State` å’Œ `Login Data` æå–å‡ºæ¥å¹¶æ­£ç¡®è§£å¯†ï¼Œ
      å®ƒå°±æ˜¯ä½ åç»­è§£å¯†ç™»å½•å‡­æ®æ‰€éœ€çš„æ ¸å¿ƒå¯†é’¥ã€‚å¦‚æœä½ è¦ç»§ç»­è§£å¯†æ•°æ®ï¼Œæ¯”å¦‚ AES-GCM çš„å¯†æ–‡ï¼ˆå« nonce + tagï¼‰ï¼Œæˆ‘å¯ä»¥ç»§ç»­å¸®ä½ ã€‚